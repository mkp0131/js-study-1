<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>ì§€ë¢°ì°¾ê¸°</title>
</head>
<body>
	<style>
		table {
			border: 1px solid #dbdbdb;
		}
		td {
			width: 30px;
			height: 30px;
			border: 1px solid #dbdbdb;
			background: #fafafa;
		}
	</style>

	<form onsubmit="gameInit();">
		ê°€ë¡œ: <input type="text" name="hor" class="js-game-hor" value="10" />
		ì„¸ë¡œ: <input type="text" name="ver" class="js-game-ver" value="10" />
		ì§€ë¢°: <input type="text" name="mine" class="js-game-mine" value="20" />
		<button type="submit">ìƒì„±</button>
	</form>
	<hr />


	<script>
		let madeGame = false;
		const gameInit = () => {
			// ì„œë¸Œë°‹ ë°©ì§€
			event.preventDefault();

			// ê²Œì„ì¤‘ë³µìƒì„±ë°©ì§€
			if(madeGame) return;
			madeGame = true;

			// input value ê°€ì ¸ì˜¤ê¸°
			const gameHor = parseInt(document.querySelector('.js-game-hor').value);
			const gameVer = parseInt(document.querySelector('.js-game-ver').value);
			const gameMine = parseInt(document.querySelector('.js-game-mine').value);
	
			// ê²Œì„ë°ì´í„° ìƒì„± (1: ì•ˆì „, 2: ì§€ë¢°)
			let gameBoard = [];
			for (let index = 0; index < gameVer; index++) {
				let gameBoardRow = Array(gameHor).fill().map(item => 1);
				gameBoard.push(gameBoardRow);
			}

			// ì§€ë¢°ìƒì„±
			let gameBoardRange = gameHor * gameVer;
			let gameBoardMineNumbers = [];
			let gameBoardNumbers = Array(gameBoardRange).fill().map((item, index) => index + 1);
			while (gameBoardNumbers.length > gameBoardRange - gameMine) {
				gameBoardMineNumbers.push(gameBoardNumbers.splice(Math.random() * gameBoardNumbers.length, 1)[0]);
			}
			gameBoardMineNumbers.sort((a,b) => a - b);

			// ê²Œì„ë³´ë“œ ìƒì„±
			const table = document.createElement('table');
			table.classList.add('js-game-board');
			gameBoard.forEach((row, rowIndex) => {
				const tr = document.createElement('tr');
				row.forEach((ver, verIndex) => {
					const td = document.createElement('td');
					td.dataset.no = (rowIndex * gameHor) + (verIndex + 1);
					tr.appendChild(td);
				})
				table.appendChild(tr);
			});
			document.body.appendChild(table);

			// ê²Œì„ë³´ë“œì— ì§€ë¢° ì‹¬ê¸° & ê²Œì„ë°ì´í„°ì— ì§€ë¢° ë„£ê¸°
			gameBoardMineNumbers.forEach(num => {
				const target = document.querySelector(`.js-game-board td[data-no="${num}"]`);
				target.innerHTML = 'ğŸ’£';
				const mineRow = Math.floor(num / gameHor);
				const mineCol = (num % gameHor) - 1;
				gameBoard[mineRow][mineCol] = 2;
			});
			

			console.log('gameBoard', gameBoard);
		}
	</script>
</body>
</html>